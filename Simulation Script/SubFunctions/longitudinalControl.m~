function [Fx,omega] = longitudinalControl(Torque,x, Fz, FxBrakes,Iyw,omega,sampleTime,tireLoad,tireSlipX,tireForceX,wRadius)
u = x(1);

if u == 0
    slip(omega == 0) = 0;
    slip(omega ~= 0) = tireSlipX(end);
else
    slip = (omega*wRadius-u)/u;
end

Fx = interp2(tireLoad,tireSlipX, tireForceX,Fz,slip','linear',Fz/tireLoad(1)*interp1(tireSlipX,tireForceX(:,1),slip'));

omegaDot = (-Fx+Torque+FxBrakes)/Iyw;
omega = omegaDot*sampleTime;

end